!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e){e.exports={defaultOptions:{lang:"ru",point:"DME",timeout:5e3,sortBy:{fieldName:"Distance",fieldNum:8},sortAsc:"ASC",locationAccuracy:2,messageBoxSelector:".fr24__messagebox",mainSelector:".fr24-app",contentSelectors:{containerClass:"fr24-table",headerClass:"fr24-table__header",contentClass:"fr24-table__content",rowClass:"fr24-table__row",itemClass:"fr24-table__item"}},dataFields:[{column:1,key:"Longitude",en:{unit:"&deg;"},ru:{title:"Широта",unit:"&deg;"}},{column:2,key:"Latitude",en:{unit:"&deg;"},ru:{title:"Долгота",unit:"&deg;"}},{column:5,key:"Speed",func:"miles2km",en:{unit:"km/h"},ru:{title:"Скорость",unit:"км/ч"}},{column:3,key:"Course",en:{unit:"&deg;"},ru:{title:"Курс",unit:"&deg;"}},{column:4,key:"Altitude",func:"feet2meters",en:{unit:"m."},ru:{title:"Высота полета",unit:"м."}},{column:11,key:"Departure",en:{unit:"IATA"},ru:{title:"Вылет",unit:"IATA"}},{column:12,key:"Arrival",en:{unit:"IATA"},ru:{title:"Прилет",unit:"IATA"}},{column:13,key:"Flight number",en:{unit:""},ru:{title:"Номер рейса",unit:""}},{column:"",key:"Distance",func:"getDistanceLatLonInKm",hide:!0,en:{unit:"m."},ru:{title:"Расстояние",unit:"м."}}],serviceUrl:"https://data-live.flightradar24.com/zones/fcgi/feed.js",serviceInput:"bounds",locations:{DME:{lat:55.410307,lon:37.902451}},errors:{critical:{ru:"Выполнение приложения будет приостановлено.",en:"Application will be stopped."},locationError:{ru:"Не верные координаты локации, выберите другую точку.",en:"Wrong location coordinates, select another one."},noServiceUrl:{type:"critical",ru:"Не верный адрес сервиса.",en:"Wrong service url."},noServiceInput:{type:"critical",ru:"Не верный параметр сервиса.",en:"Wrong service input parameter."},connectionError:{ru:"Ошибка связи с сервером",en:"Server connection error"},callbackFailed:{ru:"Не удалось обновить данные",en:"Callback failed"}}}},function(e,t,n){"use strict";n.r(t);var r=n(0);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i,a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.selector=t,this.message="",this.init()}var t,n;return t=e,(n=[{key:"init",value:function(){this.box=document.querySelector(this.selector)||null,this.hide()}},{key:"setMsg",value:function(e){this.box&&(this.box.innerText=e,this.show())}},{key:"show",value:function(){var e=this;this.box&&(this.box.style.display=""),setTimeout(function(){e.hide()},5e3)}},{key:"hide",value:function(){this.box&&(this.box.style.display="none")}},{key:"clear",value:function(){this.box&&(this.box.innerText="")}}])&&o(t.prototype,n),e}(),s={getDistanceLatLonInKm:function(e,t,n,r){var o=(n-e)*Math.PI/180,i=(r-t)*Math.PI/180,a=Math.sin(o/2)*Math.sin(o/2)+Math.cos(e*Math.PI/180)*Math.cos(n*Math.PI/180)*Math.sin(i/2)*Math.sin(i/2),s=2*Math.asin(Math.sqrt(a));return parseInt(6371*s*1e3)},deg2rad:function(e){return e*(Math.PI/180)},miles2km:function(e){return 1.852*e},feet2meters:function(e){return.3048*e}};function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}var f=function(){function e(t){u(this,e),this.serv=t,this.msgBox=new a(t.options.messageBoxSelector),this.loaderCallback=function(){window.fr24daemon.serv.checkData(this)}}return d(e,[{key:"updateTrigger",value:function(){setTimeout(this.update,i.serv.options.timeout)}},{key:"update",value:function(){i.status="update",window.fr24daemon.serv.init()}},{key:"errors",value:function(e){var t=i.errors[e][i.options.lang];if("critical"===i.errors[e].type&&(t+=" "+i.errors.critical),"critical"===i.errors[e].type)throw i.status="error",Error(t);i.msgBox.setMsg(t)}}]),e}(),p=function(){function e(t){u(this,e),this.options=Object.assign({},r.defaultOptions,t),i=window.fr24daemon=new f(this),this.init()}return d(e,[{key:"init",value:function(){i.status="ready",this.response(i.loaderCallback)||i.errors("callbackFailed")}},{key:"request",value:function(){var e,t;return this.options.locationAccuracy=parseFloat(this.options.locationAccuracy),this.options.locationAccuracy<1&&(this.options.locationAccuracy=1),(e=r.locations[this.options.point]).lat=parseFloat(e.lat),e.lon=parseFloat(e.lon),e.lat&&e.lon||i.errors("locationError"),t=e.lat+this.options.locationAccuracy+","+(e.lat-this.options.locationAccuracy)+","+(e.lon-this.options.locationAccuracy)+","+(e.lon+this.options.locationAccuracy),r.serviceUrl||i.errors("noServiceUrl"),r.serviceInput||i.errors("noServiceInput"),"error"!==i.status&&r.serviceUrl+"?"+r.serviceInput+"="+t}},{key:"response",value:function(e){var t=this.request();return!(!t||"ready"!==i.status)&&fetch(t).then(function(e){return e.ok?e.json():"connectionError"}).then(function(t){return e.call(t),!0})}},{key:"checkData",value:function(e){"string"==typeof e&&i.error(e),"object"===c(e)&&this.prepareData(e)}},{key:"prepareData",value:function(e){var t,n,o=this,a=[],u=0;Object.keys(e).forEach(function(t){if("object"!==c(e[t]))delete e[t];else{var n=Object.values(e[t]);a[u]=[],r.dataFields.forEach(function(e){if(0<e.column)e.func&s[e.func]?a[u].push(s[e.func](n[e.column])):a[u].push(n[e.column]);else if("getDistanceLatLonInKm"===e.func){var t=s[e.func](a[u][0],a[u][1],r.locations[o.options.point].lat,r.locations[o.options.point].lon);a[u].push(t)}}),u++}}),a.sort((t=("ASC"===this.options.sortAsc?"":"-")+this.options.sortBy.fieldNum,n=1,"-"===t[0]&&(n=-1,t=t.substr(1)),function(e,r){return(e[t]<r[t]?-1:e[t]>r[t]?1:0)*n})),i.renderer?i.renderer.mainRender(a):i.renderer=new h(a)}}]),e}(),h=function(){function e(t){u(this,e),this.data=t,this.mainRender(t)}return d(e,[{key:"mainRender",value:function(e){this.data=e,i.view||(i.view={},this.mainCreate(),this.headerCreate(),this.contentCreate()),this.dataUpdate(),i.status="finish",i.updateTrigger()}},{key:"mainCreate",value:function(){var e=document.querySelector(i.serv.options.mainSelector);e||i.error("renderMainError"),e.classList.add(i.serv.options.contentSelectors.containerClass),i.view.main=e}},{key:"headerCreate",value:function(){var e;(e=document.createElement("div")).classList.add(i.serv.options.contentSelectors.rowClass,i.serv.options.contentSelectors.headerClass),i.view.header=e,i.view.main.appendChild(e),r.dataFields.forEach(function(t,n){if(!r.dataFields[n].hide){var o,a=document.createElement("div");e.append(a),a.classList.add(i.serv.options.contentSelectors.itemClass),a.dataset.column=n,o=r.dataFields[n][i.serv.options.lang].title?r.dataFields[n][i.serv.options.lang].title:r.dataFields[n].key,a.innerHTML=o+" "+(r.dataFields[n][i.serv.options.lang].unit||"")}})}},{key:"contentCreate",value:function(){var e;(e=document.createElement("div")).classList.add(i.serv.options.contentSelectors.contentClass),i.view.content=e,i.view.main.appendChild(e)}},{key:"dataUpdate",value:function(){var e=this,t=this.data,n=i.view.content,r=n.childNodes;t.forEach(function(o,a){var s;s=r[a]?r[a]:e.defaultElement(n,i.serv.options.contentSelectors.rowClass),e.rowUpdate(s,t[a])})}},{key:"rowUpdate",value:function(e,t){var n=this,o=e.childNodes;t.forEach(function(t,a){r.dataFields[a].hide||((o[a]?o[a]:n.defaultElement(e,i.serv.options.contentSelectors.itemClass)).innerText=t)})}},{key:"defaultElement",value:function(e){var t=document.createElement("div");e.appendChild(t);for(var n=arguments.length,r=new Array(1<n?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.forEach(function(e){t.classList.add(e)}),t}}]),e}();document.addEventListener("DOMContentLoaded",new p)}]);